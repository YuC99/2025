knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggplot2)
library(eurostat)
library(ggplot2)
library(eurostat)
library(lubridate)
library(dplyr)
library(tidyr)
country <- "PL"
year <- "2023"
data1 <- get_eurostat("prc_hicp_manr", time_format = "date", cache = TRUE)
data2 <- data1 %>%
filter(geo == country &
lubridate::year(TIME_PERIOD) == year &
coicop == "CP00")
View(data2)
qwe <- c("CP00")
country <- c("PL", "CZ", "DE", "FR", "IT", "ES", "NL")
year <- "2023"
data2 <- data1 %>%
filter(geo %in% country &
lubridate::year(TIME_PERIOD) == year &
coicop %in% qwe)
mean(as.numeric(data2$values[data2$geo=="PL"]))
mean(as.numeric(data2$values[data2$geo=="CZ"]))
mean(as.numeric(data2$values[data2$geo=="DE"]))
mean(as.numeric(data2$values[data2$geo=="FR"]))
mean(as.numeric(data2$values[data2$geo=="IT"]))
mean(as.numeric(data2$values[data2$geo=="ES"]))
mean(as.numeric(data2$values[data2$geo=="NL"]))
sd(as.numeric(data2$values[data2$geo=="PL"]))
sd(as.numeric(data2$values[data2$geo=="CZ"]))
sd(as.numeric(data2$values[data2$geo=="DE"]))
sd(as.numeric(data2$values[data2$geo=="FR"]))
sd(as.numeric(data2$values[data2$geo=="IT"]))
sd(as.numeric(data2$values[data2$geo=="ES"]))
sd(as.numeric(data2$values[data2$geo=="NL"]))
median(as.numeric(data2$values[data2$geo=="PL"]))
median(as.numeric(data2$values[data2$geo=="CZ"]))
median(as.numeric(data2$values[data2$geo=="DE"]))
median(as.numeric(data2$values[data2$geo=="FR"]))
median(as.numeric(data2$values[data2$geo=="IT"]))
median(as.numeric(data2$values[data2$geo=="ES"]))
median(as.numeric(data2$values[data2$geo=="NL"]))
max(as.numeric(data2$values[data2$geo=="PL"]))
min(as.numeric(data2$values[data2$geo=="PL"]))
max(as.numeric(data2$values[data2$geo=="CZ"]))
min(as.numeric(data2$values[data2$geo=="CZ"]))
max(as.numeric(data2$values[data2$geo=="DE"]))
min(as.numeric(data2$values[data2$geo=="DE"]))
max(as.numeric(data2$values[data2$geo=="FR"]))
min(as.numeric(data2$values[data2$geo=="FR"]))
max(as.numeric(data2$values[data2$geo=="IT"]))
min(as.numeric(data2$values[data2$geo=="IT"]))
max(as.numeric(data2$values[data2$geo=="ES"]))
min(as.numeric(data2$values[data2$geo=="ES"]))
max(as.numeric(data2$values[data2$geo=="NL"]))
min(as.numeric(data2$values[data2$geo=="NL"]))
des <- data2 %>%
group_by(geo) %>%
summarise(
n = n(),
mean = mean(values, na.rm = TRUE),
median = median(values, na.rm = TRUE),
min = min(values, na.rm = TRUE),
max = max(values, na.rm = TRUE),
sd = sd(values, na.rm = TRUE),
cv = sd/mean
)
summary(des)
des <- data2 %>%
group_by(geo) %>%
summarise(
n = n(),
mean = mean(values, na.rm = TRUE),
median = median(values, na.rm = TRUE),
min = min(values, na.rm = TRUE),
max = max(values, na.rm = TRUE),
sd = sd(values, na.rm = TRUE),
cv = sd/mean
)
summary(des)
wide <- data2 %>%
select(TIME_PERIOD,geo,values) %>%
pivot_wider(names_from = geo, values_from = values)
wide
cor <- wide %>%
select(-TIME_PERIOD) %>%
cor(use = "pairwise.complete.obs")
cor
wide <- data2 %>%
select(TIME_PERIOD,geo,values) %>%
pivot_wider(names_from = geo, values_from = values)
wide
cor <- wide %>%
select(-TIME_PERIOD) %>%
cor(use = "pairwise.complete.obs")
cor
ggplot(data2, aes(x = TIME_PERIOD, y = values, color = geo, group = geo)) +
geom_line(size = 1) +
geom_point() +
labs(
title = "Monthly inflation in 7 EU countries, 2023",
x = "Month",
y = "Inflation rate (y-o-y, %)",
color = "Country"
) +
theme_minimal()
ggplot(data2, aes(x = geo, y = values)) +
geom_boxplot() +
labs(
title = "Distribution of monthly inflation in 2023",
x = "Country",
y = "Inflation rate (y-o-y, %)"
) +
theme_minimal()
cor2 <- as.data.frame(cor) %>%
mutate(country1 = rownames(cor)) %>%
pivot_longer(
cols = -country1,
names_to = "country2",
values_to = "corr"
cor2 <- as.data.frame(cor) %>%
cor2 <- as.data.frame(cor) %>%
mutate(country1 = rownames(cor)) %>%
pivot_longer(
cols = -country1,
names_to = "country2",
values_to = "corr"
)
ggplot(cor2, aes(x = country1, y = country2, fill = corr)) +
geom_tile() +
scale_fill_gradient2(
limits = c(-1, 1),
midpoint = 0
) +
labs(
title = "Correlation of monthly inflation between countries (2023)",
x = "Country",
y = "Country",
fill = "Correlation"
) +
theme_minimal()
cor2 <- as.data.frame(cor) %>%
mutate(country1 = rownames(cor)) %>%
pivot_longer(
cols = -country1,
names_to = "country2",
values_to = "corr"
)
ggplot(cor2, aes(x = country1, y = country2, fill = corr)) +
geom_tile() +
scale_fill_gradient2(
limits = c(-1, 1),
midpoint = 0
) +
labs(
title = "Correlation of monthly inflation between countries (2023)",
x = "Country",
y = "Country",
fill = "Correlation"
) +
theme_minimal()
ci <- data2 %>%
group_by(geo) %>%
summarise(
n    = n(),
mean = mean(values, na.rm = TRUE),
sd   = sd(values, na.rm = TRUE)
) %>%
mutate(
se        = sd / sqrt(n),
t_crit    = qt(0.975, df = n - 1),
ci_lower  = mean - t_crit * se,
ci_upper  = mean + t_crit * se
)
ci
two_ctr <- c("PL", "DE")
data_two <- data2 %>%
filter(geo %in% two_ctr)
t_test <- t.test(
values ~ geo,
data = data_two,
var.equal = FALSE
)
t_test
two_ctr <- c("PL", "DE")
data_two <- data2 %>%
filter(geo %in% two_ctr)
t_test <- t.test(
values ~ geo,
data = data_two,
var.equal = FALSE
)
t_test
ggplot(data2, aes(x = geo, y = values)) +
geom_boxplot() +
labs(
title = "Distribution of monthly inflation in 2023",
x = "Country",
y = "Inflation rate (m-o-m, %)"
) +
theme_minimal()
trend_analysis <- data2 %>%
group_by(geo) %>%
arrange(TIME_PERIOD) %>%
summarise(
start_inflation = first(values),
end_inflation = last(values),
trend = case_when(
end_inflation < start_inflation - 1 ~ "decreasing",
end_inflation > start_inflation + 1 ~ "increasing",
TRUE ~ "stagnation"
),
change = end_inflation - start_inflation
)
View(trend_analysis)
trend_analysis
trend_analysis
ggplot(data2, aes(x = TIME_PERIOD, y = values, color = geo, group = geo)) +
geom_line(size = 1) +
geom_point() +
labs(
title = "Monthly inflation in 7 EU countries, 2023",
x = "Month",
y = "Inflation rate (m-o-m, %)",
color = "Country"
) +
theme_minimal()
